動画視聴の画面に機能を追加します。
動画を表示しているエリアの空いてる部分(video-selectionが候補)に集中度ゲージを作ります。
集中度ゲージは上から緑、黄色、オレンジ、赤色になっていて、4段階で表示します。

集中度スコアに使う情報は
・ノートPCの内蔵カメラを使って視線方向（顔の向き＋目の向き）を計測する．
・一定時間ごとに，顔が正面を向いている割合で集中度を評価する．
・出題後の顔の動き／動き始めまでの時間／解答時間／解答の正誤，等も記録する．
・右下のメモに書き込む頻度を記録する．
以下の情報を取得、保存し使います。
・出題から回答までの時間が長いと下がる（閾値を変更可能）
・出題してから目線が右（質問の憑依がある方）に動いたらプラス、そうでなければマイナス
・一定時間目線が変化しないとマイナス
・メモの入力があるとすこしプラス

目線のデータはデバッグ用に動画視聴中に見れるようにしてください（簡単に非表示にできる）




デバッグモードで取得しているカメラの映像と目線を見えるようにしてください。
また、集中度スコアが変動した時に何の動作で変動したかのログを見れるようにしてください。
集中度の表示が動画にかぶってみにくいので、戻るボタンの横に配置してください

集中度変更ログには、目線が原因で変わった、メモが原因で増えたなどの情報も載せてください

メモを入力するまで、スコア変動の理由がでてこないです。またほぼすべてのログがメモになっているのでプログラムを再確認してください

表示内容:
リアルタイムカメラ映像（160×120）
目線追跡の可視化Canvas
顔検出時：緑の枠 + 黄色い矢印で目線方向
顔未検出時：赤い×印

次に、WebRTCとMediapipe（またはそれに代わる軽量な顔・目線追跡ライブラリ）を使用するJavaScriptを追加します。まず、HTMLの<head>部分にライブラリを追加する必要があります。JavaScriptセクションの前に、必要なライブラリのCDNリンクを追加しましょう：




実装したスムージング機能
1. 移動平均フィルタ
履歴管理: 最新8フレーム分の視線データを保存
重み付き平均: 新しいデータに大きな重みを付けて平滑化
重み計算: 指数関数的な重み（1.2^index）で最新データを重視
2. ノイズ除去機能
異常値検出: 前後のデータとの差が閾値（3ピクセル）を超える場合
極端値除去: 100ピクセルを超える異常な値を自動除去
三点比較: 前・現在・次のデータを比較してスパイクノイズを検出
3. 速度・加速度のスムージング
速度制限: 最大200ピクセル/秒に制限
加速度制限: 最大500ピクセル/秒²に制限
指数移動平均: 速度30%、加速度40%の平滑化係数
4. フォールバック機能
有効データ保持: 0.5秒以内の最後の有効データを使用
データ不足対応: 3フレーム未満の場合は前回の有効値を維持
5. デバッグ情報の拡張
スムージング状態: 処理前後の値を表示
ノイズ除去率: リアルタイムでのノイズ検出率
データ品質: 有効フレーム数と履歴状況
6. 設定可能なパラメータ
smoothingWindowSize: 8フレーム（約0.27秒）
noiseThreshold: 3ピクセル
velocitySmoothing: 30%係数
accelSmoothing: 40%係数
これにより、MediaPipeの視線検出の瞬間的な誤差やノイズが大幅に軽減され、より安定した速度・加速度計算が可能になります。